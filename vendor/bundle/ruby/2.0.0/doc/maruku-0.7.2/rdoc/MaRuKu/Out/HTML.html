<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>module MaRuKu::Out::HTML - maruku-0.7.2 Documentation</title>

<link type="text/css" media="screen" href="../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/darkfish.js"></script>


<body id="top" class="module">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../../index.html">Home</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  

  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/maruku.rb
    <li>lib/maruku/ext/div.rb
    <li>lib/maruku/ext/math/mathml_engines/blahtex.rb
    <li>lib/maruku/ext/math/mathml_engines/itex2mml.rb
    <li>lib/maruku/ext/math/mathml_engines/none.rb
    <li>lib/maruku/ext/math/mathml_engines/ritex.rb
    <li>lib/maruku/ext/math/to_html.rb
    <li>lib/maruku/output/to_html.rb
    <li>lib/maruku/toc.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li ><a href="#method-c-escapeHTML">::escapeHTML</a>
    
    <li ><a href="#method-i-add_class_to">#add_class_to</a>
    
    <li ><a href="#method-i-add_css_to">#add_css_to</a>
    
    <li ><a href="#method-i-add_ws">#add_ws</a>
    
    <li ><a href="#method-i-adjust_png">#adjust_png</a>
    
    <li ><a href="#method-i-array_to_html">#array_to_html</a>
    
    <li ><a href="#method-i-children_to_html">#children_to_html</a>
    
    <li ><a href="#method-i-convert_to_mathml_blahtex">#convert_to_mathml_blahtex</a>
    
    <li ><a href="#method-i-convert_to_mathml_itex2mml">#convert_to_mathml_itex2mml</a>
    
    <li ><a href="#method-i-convert_to_mathml_none">#convert_to_mathml_none</a>
    
    <li ><a href="#method-i-convert_to_mathml_ritex">#convert_to_mathml_ritex</a>
    
    <li ><a href="#method-i-convert_to_png_blahtex">#convert_to_png_blahtex</a>
    
    <li ><a href="#method-i-convert_to_png_none">#convert_to_png_none</a>
    
    <li ><a href="#method-i-day_suffix">#day_suffix</a>
    
    <li ><a href="#method-i-html_element">#html_element</a>
    
    <li ><a href="#method-i-maruku_html_signature">#maruku_html_signature</a>
    
    <li ><a href="#method-i-nice_date">#nice_date</a>
    
    <li ><a href="#method-i-obfuscate">#obfuscate</a>
    
    <li ><a href="#method-i-pixels_per_ex">#pixels_per_ex</a>
    
    <li ><a href="#method-i-render_footnotes">#render_footnotes</a>
    
    <li ><a href="#method-i-render_mathml">#render_mathml</a>
    
    <li ><a href="#method-i-render_png">#render_png</a>
    
    <li ><a href="#method-i-render_section_number">#render_section_number</a>
    
    <li ><a href="#method-i-run_blahtex">#run_blahtex</a>
    
    <li ><a href="#method-i-section_number">#section_number</a>
    
    <li ><a href="#method-i-to_html">#to_html</a>
    
    <li ><a href="#method-i-to_html_abbr">#to_html_abbr</a>
    
    <li ><a href="#method-i-to_html_cell">#to_html_cell</a>
    
    <li ><a href="#method-i-to_html_code">#to_html_code</a>
    
    <li ><a href="#method-i-to_html_code_using_pre">#to_html_code_using_pre</a>
    
    <li ><a href="#method-i-to_html_definition">#to_html_definition</a>
    
    <li ><a href="#method-i-to_html_definition_data">#to_html_definition_data</a>
    
    <li ><a href="#method-i-to_html_definition_list">#to_html_definition_list</a>
    
    <li ><a href="#method-i-to_html_definition_term">#to_html_definition_term</a>
    
    <li ><a href="#method-i-to_html_div">#to_html_div</a>
    
    <li ><a href="#method-i-to_html_divref">#to_html_divref</a>
    
    <li ><a href="#method-i-to_html_document">#to_html_document</a>
    
    <li ><a href="#method-i-to_html_document_tree">#to_html_document_tree</a>
    
    <li ><a href="#method-i-to_html_email_address">#to_html_email_address</a>
    
    <li ><a href="#method-i-to_html_emphasis">#to_html_emphasis</a>
    
    <li ><a href="#method-i-to_html_entity">#to_html_entity</a>
    
    <li ><a href="#method-i-to_html_eqref">#to_html_eqref</a>
    
    <li ><a href="#method-i-to_html_equation">#to_html_equation</a>
    
    <li ><a href="#method-i-to_html_footnote_reference">#to_html_footnote_reference</a>
    
    <li ><a href="#method-i-to_html_head_cell">#to_html_head_cell</a>
    
    <li ><a href="#method-i-to_html_header">#to_html_header</a>
    
    <li ><a href="#method-i-to_html_hrule">#to_html_hrule</a>
    
    <li ><a href="#method-i-to_html_im_image">#to_html_im_image</a>
    
    <li ><a href="#method-i-to_html_im_link">#to_html_im_link</a>
    
    <li ><a href="#method-i-to_html_image">#to_html_image</a>
    
    <li ><a href="#method-i-to_html_immediate_link">#to_html_immediate_link</a>
    
    <li ><a href="#method-i-to_html_inline_code">#to_html_inline_code</a>
    
    <li ><a href="#method-i-to_html_inline_math">#to_html_inline_math</a>
    
    <li ><a href="#method-i-to_html_li">#to_html_li</a>
    
    <li ><a href="#method-i-to_html_linebreak">#to_html_linebreak</a>
    
    <li ><a href="#method-i-to_html_link">#to_html_link</a>
    
    <li ><a href="#method-i-to_html_ol">#to_html_ol</a>
    
    <li ><a href="#method-i-to_html_paragraph">#to_html_paragraph</a>
    
    <li ><a href="#method-i-to_html_quote">#to_html_quote</a>
    
    <li ><a href="#method-i-to_html_raw_html">#to_html_raw_html</a>
    
    <li ><a href="#method-i-to_html_ref_definition">#to_html_ref_definition</a>
    
    <li ><a href="#method-i-to_html_strong">#to_html_strong</a>
    
    <li ><a href="#method-i-to_html_table">#to_html_table</a>
    
    <li ><a href="#method-i-to_html_ul">#to_html_ul</a>
    
    <li ><a href="#method-i-to_html_xml_instr">#to_html_xml_instr</a>
    
    <li ><a href="#method-i-to_latex_ref_definition">#to_latex_ref_definition</a>
    
    <li ><a href="#method-i-wrap_as_element">#wrap_as_element</a>
    
    <li ><a href="#method-i-xelem">#xelem</a>
    
    <li ><a href="#method-i-xml_newline">#xml_newline</a>
    
    <li ><a href="#method-i-xtext">#xtext</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    
    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../../MaRuKu.html">MaRuKu</a>
  
    <li><a href="../../MaRuKu/AttributeList.html">MaRuKu::AttributeList</a>
  
    <li><a href="../../MaRuKu/Errors.html">MaRuKu::Errors</a>
  
    <li><a href="../../MaRuKu/Exception.html">MaRuKu::Exception</a>
  
    <li><a href="../../MaRuKu/HTMLElement.html">MaRuKu::HTMLElement</a>
  
    <li><a href="../../MaRuKu/HTMLFragment.html">MaRuKu::HTMLFragment</a>
  
    <li><a href="../../MaRuKu/Helpers.html">MaRuKu::Helpers</a>
  
    <li><a href="../../MaRuKu/In.html">MaRuKu::In</a>
  
    <li><a href="../../MaRuKu/In.html">MaRuKu::In</a>
  
    <li><a href="../../MaRuKu/In/Markdown.html">MaRuKu::In::Markdown</a>
  
    <li><a href="../../MaRuKu/In/Markdown.html">MaRuKu::In::Markdown</a>
  
    <li><a href="../../MaRuKu/In/Markdown/BlockLevelParser.html">MaRuKu::In::Markdown::BlockLevelParser</a>
  
    <li><a href="../../MaRuKu/In/Markdown/BlockLevelParser/BlockContext.html">MaRuKu::In::Markdown::BlockLevelParser::BlockContext</a>
  
    <li><a href="../../MaRuKu/In/Markdown/BlockLevelParser/LineSource.html">MaRuKu::In::Markdown::BlockLevelParser::LineSource</a>
  
    <li><a href="../../MaRuKu/In/Markdown/SpanExtension.html">MaRuKu::In::Markdown::SpanExtension</a>
  
    <li><a href="../../MaRuKu/In/Markdown/SpanLevelParser.html">MaRuKu::In::Markdown::SpanLevelParser</a>
  
    <li><a href="../../MaRuKu/In/Markdown/SpanLevelParser/CharSourceDebug.html">MaRuKu::In::Markdown::SpanLevelParser::CharSourceDebug</a>
  
    <li><a href="../../MaRuKu/In/Markdown/SpanLevelParser/CharSourceManual.html">MaRuKu::In::Markdown::SpanLevelParser::CharSourceManual</a>
  
    <li><a href="../../MaRuKu/In/Markdown/SpanLevelParser/CharSourceStrscan.html">MaRuKu::In::Markdown::SpanLevelParser::CharSourceStrscan</a>
  
    <li><a href="../../MaRuKu/In/Markdown/SpanLevelParser/HTMLHelper.html">MaRuKu::In::Markdown::SpanLevelParser::HTMLHelper</a>
  
    <li><a href="../../MaRuKu/In/Markdown/SpanLevelParser/SpanContext.html">MaRuKu::In::Markdown::SpanLevelParser::SpanContext</a>
  
    <li><a href="../../MaRuKu/MDDocument.html">MaRuKu::MDDocument</a>
  
    <li><a href="../../MaRuKu/MDElement.html">MaRuKu::MDElement</a>
  
    <li><a href="../../MaRuKu/MDHTMLElement.html">MaRuKu::MDHTMLElement</a>
  
    <li><a href="../../MaRuKu/MDLine.html">MaRuKu::MDLine</a>
  
    <li><a href="../../MaRuKu/NokogiriHTMLFragment.html">MaRuKu::NokogiriHTMLFragment</a>
  
    <li><a href="../../MaRuKu/Out.html">MaRuKu::Out</a>
  
    <li><a href="../../MaRuKu/Out/EntityTable.html">MaRuKu::Out::EntityTable</a>
  
    <li><a href="../../MaRuKu/Out/HTML.html">MaRuKu::Out::HTML</a>
  
    <li><a href="../../MaRuKu/Out/HTML/HTMLElement.html">MaRuKu::Out::HTML::HTMLElement</a>
  
    <li><a href="../../MaRuKu/Out/Latex.html">MaRuKu::Out::Latex</a>
  
    <li><a href="../../MaRuKu/Out/Latex/MDDocumentExtensions.html">MaRuKu::Out::Latex::MDDocumentExtensions</a>
  
    <li><a href="../../MaRuKu/Out/Markdown.html">MaRuKu::Out::Markdown</a>
  
    <li><a href="../../MaRuKu/REXMLHTMLFragment.html">MaRuKu::REXMLHTMLFragment</a>
  
    <li><a href="../../MaRuKu/Section.html">MaRuKu::Section</a>
  
    <li><a href="../../MaRuKu/Strings.html">MaRuKu::Strings</a>
  
    <li><a href="../../Maruku.html">Maruku</a>
  
    <li><a href="../../Maruku.html">Maruku</a>
  
    <li><a href="../../Maruku/In/Markdown/FencedCode.html">Maruku::In::Markdown::FencedCode</a>
  
    <li><a href="../../Object.html">Object</a>
  
    <li><a href="../../String.html">String</a>
  
    <li><a href="../../Textile2Signature.html">Textile2Signature</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="module">module MaRuKu::Out::HTML</h1>

  <div id="description" class="description">
    
<p>This module groups all functions related to <a href="HTML.html">HTML</a>
export.</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <!-- Constants -->
    <section id="constants-list" class="section">
      <h3 class="section-header">Constants</h3>
      <dl>
      
        <dt id="HTML4Attributes">HTML4Attributes
        
        <dd class="description"><h1 id="label-begin+maruku_doc">begin maruku_doc<span><a href="#label-begin+maruku_doc">&para;</a> <a href="#documentation">&uarr;</a></span></h1>

<pre>Attribute: style
Scope: element
Output: HTML

It is copied as a standard HTML attribute.</pre>

<h1 id="label-end">end<span><a href="#label-end">&para;</a> <a href="#documentation">&uarr;</a></span></h1>
        
      
        <dt id="PNG">PNG
        
        <dd class="description">
        
      
        <dt id="Xhtml11_mathml2_svg11">Xhtml11_mathml2_svg11
        
        <dd class="description">
        
      
      </dl>
    </section>
    

    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-escapeHTML" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">escapeHTML</span><span
            class="method-args">(text)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Escape text for use in <a href="HTML.html">HTML</a> (content or attributes)
by running it through standard XML escaping (quotes and angle brackets and
ampersands)</p>
          
          

          
          <div class="method-source-code" id="escapeHTML-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 9</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">escapeHTML</span>(<span class="ruby-identifier">text</span>)
  <span class="ruby-constant">CGI</span>.<span class="ruby-identifier">escapeHTML</span>(<span class="ruby-identifier">text</span>)
  <span class="ruby-comment"># TODO: When we drop Rubies &lt; 1.9.3, re-add .gsub(/[^[:print:]\n\r\t]/, &#39;&#39;) to</span>
  <span class="ruby-comment"># get rid of non-printable control characters.</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- escapeHTML-source -->
          
        </div>

        

        
      </div><!-- escapeHTML-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-add_class_to" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_class_to</span><span
            class="method-args">(el, cl)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="add_class_to-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 634</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_class_to</span>(<span class="ruby-identifier">el</span>, <span class="ruby-identifier">cl</span>)
  <span class="ruby-identifier">el</span>[<span class="ruby-string">&#39;class&#39;</span>] =
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">already</span> = <span class="ruby-identifier">el</span>[<span class="ruby-string">&#39;class&#39;</span>]
      <span class="ruby-identifier">already</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">cl</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">cl</span>
    <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- add_class_to-source -->
          
        </div>

        

        
      </div><!-- add_class_to-method -->

    
      <div id="method-i-add_css_to" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_css_to</span><span
            class="method-args">(head)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="add_css_to-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 231</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_css_to</span>(<span class="ruby-identifier">head</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">css_list</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">attributes</span>[<span class="ruby-value">:css</span>]
    <span class="ruby-identifier">css_list</span>.<span class="ruby-identifier">split</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">css</span><span class="ruby-operator">|</span>
      <span class="ruby-comment"># &lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;...&quot; /&gt;</span>
      <span class="ruby-identifier">link</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;link&#39;</span>)
      <span class="ruby-identifier">link</span>[<span class="ruby-string">&#39;type&#39;</span>] = <span class="ruby-string">&#39;text/css&#39;</span>
      <span class="ruby-identifier">link</span>[<span class="ruby-string">&#39;rel&#39;</span>] = <span class="ruby-string">&#39;stylesheet&#39;</span>
      <span class="ruby-identifier">link</span>[<span class="ruby-string">&#39;href&#39;</span>] = <span class="ruby-identifier">css</span>
      <span class="ruby-identifier">head</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">link</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xml_newline</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- add_css_to-source -->
          
        </div>

        

        
      </div><!-- add_css_to-method -->

    
      <div id="method-i-add_ws" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_ws</span><span
            class="method-args">(e)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="add_ws-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 682</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_ws</span>(<span class="ruby-identifier">e</span>)
  [<span class="ruby-identifier">xml_newline</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">xml_newline</span>]
<span class="ruby-keyword">end</span></pre>
          </div><!-- add_ws-source -->
          
        </div>

        

        
      </div><!-- add_ws-method -->

    
      <div id="method-i-adjust_png" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">adjust_png</span><span
            class="method-args">(png, use_depth)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="adjust_png-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/to_html.rb, line 79</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">adjust_png</span>(<span class="ruby-identifier">png</span>, <span class="ruby-identifier">use_depth</span>)
  <span class="ruby-identifier">src</span> = <span class="ruby-identifier">png</span>.<span class="ruby-identifier">src</span>

  <span class="ruby-identifier">height_in_px</span> = <span class="ruby-identifier">png</span>.<span class="ruby-identifier">height</span>
  <span class="ruby-identifier">depth_in_px</span> = <span class="ruby-identifier">png</span>.<span class="ruby-identifier">depth</span>
  <span class="ruby-identifier">height_in_ex</span> = <span class="ruby-identifier">height_in_px</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">pixels_per_ex</span>
  <span class="ruby-identifier">depth_in_ex</span> = <span class="ruby-identifier">depth_in_px</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">pixels_per_ex</span>
  <span class="ruby-identifier">total_height_in_ex</span> = <span class="ruby-identifier">height_in_ex</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">depth_in_ex</span>
  <span class="ruby-identifier">style</span> = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-identifier">style</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;vertical-align: -#{depth_in_ex}ex;&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_depth</span>
  <span class="ruby-identifier">style</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;height: #{total_height_in_ex}ex;&quot;</span>

  <span class="ruby-identifier">img</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;img&#39;</span>)
  <span class="ruby-identifier">img</span>[<span class="ruby-string">&#39;src&#39;</span>] = <span class="ruby-identifier">src</span>
  <span class="ruby-identifier">img</span>[<span class="ruby-string">&#39;style&#39;</span>] = <span class="ruby-identifier">style</span>
  <span class="ruby-identifier">img</span>[<span class="ruby-string">&#39;alt&#39;</span>] = <span class="ruby-node">&quot;$#{self.math.strip}$&quot;</span>
  <span class="ruby-identifier">img</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-string">&#39;maruku-png&#39;</span>
  <span class="ruby-identifier">img</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- adjust_png-source -->
          
        </div>

        

        
      </div><!-- adjust_png-method -->

    
      <div id="method-i-array_to_html" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">array_to_html</span><span
            class="method-args">(array)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="array_to_html-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 877</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">array_to_html</span>(<span class="ruby-identifier">array</span>)
  <span class="ruby-identifier">e</span> = []
  <span class="ruby-identifier">array</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">String</span>)
      <span class="ruby-identifier">e</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-identifier">c</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">HTMLElement</span>)
        <span class="ruby-identifier">e</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>
        <span class="ruby-keyword">next</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">method</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">MaRuKu</span><span class="ruby-operator">::</span><span class="ruby-constant">MDElement</span>) <span class="ruby-operator">?</span> <span class="ruby-node">&quot;to_html_#{c.node_type}&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-string">&quot;to_html&quot;</span>
      <span class="ruby-keyword">next</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>)

      <span class="ruby-identifier">h</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>)

      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">h</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Nil html created by method  #{method}:\n#{h.inspect}\n&quot;</span> <span class="ruby-operator">+</span>
          <span class="ruby-node">&quot; for object #{c.inspect[0,300]}&quot;</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">h</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Array</span>
        <span class="ruby-identifier">e</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">h</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">e</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">h</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- array_to_html-source -->
          
        </div>

        

        
      </div><!-- array_to_html-method -->

    
      <div id="method-i-children_to_html" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">children_to_html</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Convert each child to html</p>
          
          

          
          <div class="method-source-code" id="children_to_html-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 873</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">children_to_html</span>
  <span class="ruby-identifier">array_to_html</span>(<span class="ruby-ivar">@children</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- children_to_html-source -->
          
        </div>

        

        
      </div><!-- children_to_html-method -->

    
      <div id="method-i-convert_to_mathml_blahtex" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_to_mathml_blahtex</span><span
            class="method-args">(kind, tex)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="convert_to_mathml_blahtex-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/mathml_engines/blahtex.rb, line 59</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">convert_to_mathml_blahtex</span>(<span class="ruby-identifier">kind</span>, <span class="ruby-identifier">tex</span>)
  <span class="ruby-identifier">result</span> = <span class="ruby-identifier">run_blahtex</span>(<span class="ruby-identifier">tex</span>, <span class="ruby-node">%w[--mathml]</span>)

  <span class="ruby-identifier">doc</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">result</span>)
  <span class="ruby-identifier">mathml</span> = <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">get_elements</span>(<span class="ruby-string">&#39;//markup&#39;</span>).<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">first</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">mathml</span>
    <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Blahtex error: \n#{doc}&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">mathml</span>.<span class="ruby-identifier">name</span> = <span class="ruby-string">&#39;math&#39;</span>
  <span class="ruby-identifier">mathml</span>.<span class="ruby-identifier">attributes</span>[<span class="ruby-string">&#39;xmlns&#39;</span>] = <span class="ruby-string">&quot;http://www.w3.org/1998/Math/MathML&quot;</span>
  <span class="ruby-identifier">mathml</span>.<span class="ruby-identifier">attributes</span>[<span class="ruby-string">&#39;display&#39;</span>] = (<span class="ruby-identifier">kind</span> <span class="ruby-operator">==</span> <span class="ruby-value">:inline</span>) <span class="ruby-operator">?</span> <span class="ruby-value">:inline</span> <span class="ruby-operator">:</span> <span class="ruby-value">:block</span>

  <span class="ruby-constant">MaRuKu</span><span class="ruby-operator">::</span><span class="ruby-constant">HTMLFragment</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">mathml</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Error: #{e}&quot;</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- convert_to_mathml_blahtex-source -->
          
        </div>

        

        
      </div><!-- convert_to_mathml_blahtex-method -->

    
      <div id="method-i-convert_to_mathml_itex2mml" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_to_mathml_itex2mml</span><span
            class="method-args">(kind, tex)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="convert_to_mathml_itex2mml-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/mathml_engines/itex2mml.rb, line 2</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">convert_to_mathml_itex2mml</span>(<span class="ruby-identifier">kind</span>, <span class="ruby-identifier">tex</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$already_warned_itex2mml</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;itextomml&#39;</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">LoadError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
    <span class="ruby-identifier">maruku_error</span> <span class="ruby-string">&quot;Could not load package &#39;itex2mml&#39;.\nPlease install it.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">$already_warned_itex2mml</span>
    <span class="ruby-identifier">$already_warned_itex2mml</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;instiki_stringsupport&#39;</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">LoadError</span>
    <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;itex_stringsupport&#39;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">parser</span> = <span class="ruby-constant">Itex2MML</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">mathml</span> =
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">kind</span>
    <span class="ruby-keyword">when</span> <span class="ruby-value">:equation</span>
      <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">block_filter</span>(<span class="ruby-identifier">tex</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-value">:inline</span>
      <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">inline_filter</span>(<span class="ruby-identifier">tex</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Unknown itex2mml kind: #{kind}&quot;</span>
      <span class="ruby-keyword">return</span>
    <span class="ruby-keyword">end</span>

  <span class="ruby-constant">MaRuKu</span><span class="ruby-operator">::</span><span class="ruby-constant">HTMLFragment</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">mathml</span>.<span class="ruby-identifier">to_utf8</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Invalid MathML TeX: \n#{tex.gsub(/^/, &#39;tex&gt;&#39;)}\n\n #{e.inspect}&quot;</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- convert_to_mathml_itex2mml-source -->
          
        </div>

        

        
      </div><!-- convert_to_mathml_itex2mml-method -->

    
      <div id="method-i-convert_to_mathml_none" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_to_mathml_none</span><span
            class="method-args">(kind, tex)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="convert_to_mathml_none-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/mathml_engines/none.rb, line 2</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">convert_to_mathml_none</span>(<span class="ruby-identifier">kind</span>, <span class="ruby-identifier">tex</span>)
  <span class="ruby-identifier">code</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;code&#39;</span>)
  <span class="ruby-identifier">tex_node</span> = <span class="ruby-identifier">xtext</span>(<span class="ruby-identifier">tex</span>)
  <span class="ruby-identifier">code</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">tex_node</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- convert_to_mathml_none-source -->
          
        </div>

        

        
      </div><!-- convert_to_mathml_none-method -->

    
      <div id="method-i-convert_to_mathml_ritex" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_to_mathml_ritex</span><span
            class="method-args">(kind, tex)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="convert_to_mathml_ritex-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/mathml_engines/ritex.rb, line 2</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">convert_to_mathml_ritex</span>(<span class="ruby-identifier">kind</span>, <span class="ruby-identifier">tex</span>)
        <span class="ruby-keyword">begin</span>
                <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">$ritex_parser</span>
                        <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;ritex&#39;</span>
                     <span class="ruby-identifier">$ritex_parser</span> = <span class="ruby-constant">Ritex</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">new</span>
                <span class="ruby-keyword">end</span>
                
                <span class="ruby-identifier">mathml</span> =  <span class="ruby-identifier">$ritex_parser</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">tex</span>.<span class="ruby-identifier">strip</span>)
                <span class="ruby-identifier">doc</span> = <span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">mathml</span>, {<span class="ruby-value">:respect_whitespace</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">:all</span>}).<span class="ruby-identifier">root</span>
                <span class="ruby-keyword">return</span> <span class="ruby-identifier">doc</span>
        <span class="ruby-keyword">rescue</span> <span class="ruby-constant">LoadError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
                <span class="ruby-identifier">maruku_error</span> <span class="ruby-string">&quot;Could not load package &#39;ritex&#39;.\n&quot;</span><span class="ruby-operator">+</span>
                <span class="ruby-string">&quot;Please install it using:\n&quot;</span><span class="ruby-operator">+</span>
                <span class="ruby-string">&quot;   $ gem install ritex\n\n&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">e</span>.<span class="ruby-identifier">inspect</span>
        <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Racc</span><span class="ruby-operator">::</span><span class="ruby-constant">ParseError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
                <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Could not parse TeX: \n#{tex}&quot;</span><span class="ruby-operator">+</span>
                        <span class="ruby-node">&quot;\n\n #{e.inspect}&quot;</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- convert_to_mathml_ritex-source -->
          
        </div>

        

        
      </div><!-- convert_to_mathml_ritex-method -->

    
      <div id="method-i-convert_to_png_blahtex" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_to_png_blahtex</span><span
            class="method-args">(kind, tex)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="convert_to_png_blahtex-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/mathml_engines/blahtex.rb, line 8</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">convert_to_png_blahtex</span>(<span class="ruby-identifier">kind</span>, <span class="ruby-identifier">tex</span>)
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:html_png_dir</span>)

  <span class="ruby-comment"># first, we check whether this image has already been processed</span>
  <span class="ruby-identifier">md5sum</span> = <span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-identifier">tex</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; params: &quot;</span>)
  <span class="ruby-identifier">result_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:html_png_dir</span>), <span class="ruby-identifier">md5sum</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;.txt&quot;</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">result_file</span>)
    <span class="ruby-identifier">result</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">result_file</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">args</span> = [
            <span class="ruby-string">&#39;--png&#39;</span>,
            <span class="ruby-string">&#39;--use-preview-package&#39;</span>,
            <span class="ruby-string">&#39;--shell-dvipng&#39;</span>,
            <span class="ruby-node">&quot;dvipng -D #{Shellwords.shellescape(get_setting(:html_png_resolution).to_s)}&quot;</span>,
            <span class="ruby-node">&quot;--temp-directory #{Shellwords.shellescape(get_setting(:html_png_dir))}&quot;</span>,
            <span class="ruby-node">&quot;--png-directory #{Shellwords.shellescape(get_setting(:html_png_dir))}&quot;</span>
           ]
    <span class="ruby-identifier">args</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;--displaymath&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">kind</span> <span class="ruby-operator">==</span> <span class="ruby-value">:equation</span>

    <span class="ruby-identifier">result</span> = <span class="ruby-identifier">run_blahtex</span>(<span class="ruby-identifier">tex</span>, <span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">maruku_error</span> <span class="ruby-string">&quot;Blahtex error: empty output&quot;</span>
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">doc</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">result</span>)
  <span class="ruby-identifier">png</span> = <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">root</span>.<span class="ruby-identifier">elements</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">first</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">png</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;png&#39;</span>
    <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Blahtex error: \n#{doc}&quot;</span>
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;No depth element in:\n #{doc}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">depth</span> = <span class="ruby-identifier">png</span>.<span class="ruby-identifier">xpath</span>(<span class="ruby-string">&#39;//depth&#39;</span>)[<span class="ruby-value">0</span>]
  <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;No height element in:\n #{doc}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">height</span> = <span class="ruby-identifier">png</span>.<span class="ruby-identifier">xpath</span>(<span class="ruby-string">&#39;//height&#39;</span>)[<span class="ruby-value">0</span>]
  <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;No md5 element in:\n #{doc}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">md5</span> = <span class="ruby-identifier">png</span>.<span class="ruby-identifier">xpath</span>(<span class="ruby-string">&#39;//md5&#39;</span>)[<span class="ruby-value">0</span>]

  <span class="ruby-identifier">depth</span> = <span class="ruby-identifier">depth</span>.<span class="ruby-identifier">text</span>.<span class="ruby-identifier">to_f</span>
  <span class="ruby-identifier">height</span> = <span class="ruby-identifier">height</span>.<span class="ruby-identifier">text</span>.<span class="ruby-identifier">to_f</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Height or depth was 0! in \n #{doc}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">height</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">depth</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>

  <span class="ruby-identifier">md5</span> = <span class="ruby-identifier">md5</span>.<span class="ruby-identifier">text</span>

  <span class="ruby-constant">PNG</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{get_setting(:html_png_url)}#{md5}.png&quot;</span>, <span class="ruby-identifier">depth</span>, <span class="ruby-identifier">height</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Error: #{e}&quot;</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- convert_to_png_blahtex-source -->
          
        </div>

        

        
      </div><!-- convert_to_png_blahtex-method -->

    
      <div id="method-i-convert_to_png_none" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_to_png_none</span><span
            class="method-args">(kind, tex)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="convert_to_png_none-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/mathml_engines/none.rb, line 8</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">convert_to_png_none</span>(<span class="ruby-identifier">kind</span>, <span class="ruby-identifier">tex</span>)
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- convert_to_png_none-source -->
          
        </div>

        

        
      </div><!-- convert_to_png_none-method -->

    
      <div id="method-i-day_suffix" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">day_suffix</span><span
            class="method-args">(day)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>returns “st”,“nd”,“rd” or “th” as appropriate</p>
          
          

          
          <div class="method-source-code" id="day_suffix-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 245</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">day_suffix</span>(<span class="ruby-identifier">day</span>)
  <span class="ruby-identifier">s</span> = {
    <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;st&#39;</span>,
    <span class="ruby-value">2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;nd&#39;</span>,
    <span class="ruby-value">3</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;rd&#39;</span>,
    <span class="ruby-value">21</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;st&#39;</span>,
    <span class="ruby-value">22</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;nd&#39;</span>,
    <span class="ruby-value">23</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;rd&#39;</span>,
    <span class="ruby-value">31</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;st&#39;</span>
  }
  <span class="ruby-identifier">s</span>[<span class="ruby-identifier">day</span>] <span class="ruby-operator">||</span> <span class="ruby-string">&#39;th&#39;</span>;
<span class="ruby-keyword">end</span></pre>
          </div><!-- day_suffix-source -->
          
        </div>

        

        
      </div><!-- day_suffix-method -->

    
      <div id="method-i-html_element" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">html_element</span><span
            class="method-args">(name, content="", attributes={}) { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Pretty much the same as the <a href="HTML/HTMLElement.html">HTMLElement</a>
constructor except it copies standard attributes out of the <a
href="../../Maruku.html">Maruku</a> Element&#39;s attributes hash.</p>
          
          

          
          <div class="method-source-code" id="html_element-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 396</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">html_element</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">content</span>=<span class="ruby-string">&quot;&quot;</span>, <span class="ruby-identifier">attributes</span>={})
  <span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">content</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">content</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)

  <span class="ruby-constant">Array</span>(<span class="ruby-constant">HTML4Attributes</span>[<span class="ruby-identifier">name</span>]).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">att</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span> = <span class="ruby-ivar">@attributes</span>[<span class="ruby-identifier">att</span>]
      <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">att</span>.<span class="ruby-identifier">to_s</span>] = <span class="ruby-constant">MaRuKu</span><span class="ruby-operator">::</span><span class="ruby-constant">Out</span><span class="ruby-operator">::</span><span class="ruby-constant">HTML</span>.<span class="ruby-identifier">escapeHTML</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">content</span> = <span class="ruby-keyword">yield</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>

  <span class="ruby-constant">HTMLElement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">attributes</span>, <span class="ruby-identifier">content</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- html_element-source -->
          
        </div>

        

        
      </div><!-- html_element-method -->

    
      <div id="method-i-maruku_html_signature" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">maruku_html_signature</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="maruku_html_signature-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 265</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">maruku_html_signature</span>
  <span class="ruby-identifier">div</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;div&#39;</span>)
  <span class="ruby-identifier">div</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-string">&#39;maruku_signature&#39;</span>
  <span class="ruby-identifier">div</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;hr&#39;</span>)
  <span class="ruby-identifier">span</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;span&#39;</span>)
  <span class="ruby-identifier">span</span>[<span class="ruby-string">&#39;style&#39;</span>] = <span class="ruby-string">&#39;font-size: small; font-style: italic&#39;</span>
  <span class="ruby-identifier">div</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">span</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-string">&#39;Created by &#39;</span>)
  <span class="ruby-identifier">a</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;a&#39;</span>)
  <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;href&#39;</span>] = <span class="ruby-constant">MaRuKu</span><span class="ruby-operator">::</span><span class="ruby-constant">MARUKU_URL</span>
  <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;title&#39;</span>] = <span class="ruby-string">&#39;Maruku: a Markdown-superset interpreter for Ruby&#39;</span>
  <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-string">&#39;Maruku&#39;</span>)
  <span class="ruby-identifier">span</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-identifier">nice_date</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;.&quot;</span>)
  <span class="ruby-identifier">div</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- maruku_html_signature-source -->
          
        </div>

        

        
      </div><!-- maruku_html_signature-method -->

    
      <div id="method-i-nice_date" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">nice_date</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>formats a nice date</p>
          
          

          
          <div class="method-source-code" id="nice_date-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 259</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">nice_date</span>
  <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&quot; at %H:%M on %A, %B %d&quot;</span>) <span class="ruby-operator">+</span>
    <span class="ruby-identifier">day_suffix</span>(<span class="ruby-identifier">t</span>.<span class="ruby-identifier">day</span>) <span class="ruby-operator">+</span>
    <span class="ruby-identifier">t</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&quot;, %Y&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- nice_date-source -->
          
        </div>

        

        
      </div><!-- nice_date-method -->

    
      <div id="method-i-obfuscate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">obfuscate</span><span
            class="method-args">(s)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Email address</p>
          
          

          
          <div class="method-source-code" id="obfuscate-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 688</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">obfuscate</span>(<span class="ruby-identifier">s</span>)
  <span class="ruby-identifier">s</span>.<span class="ruby-identifier">bytes</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-string">&#39;&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">res</span>, <span class="ruby-identifier">char</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&amp;#%03d;&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">char</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- obfuscate-source -->
          
        </div>

        

        
      </div><!-- obfuscate-method -->

    
      <div id="method-i-pixels_per_ex" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pixels_per_ex</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="pixels_per_ex-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/to_html.rb, line 75</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pixels_per_ex</span>
  <span class="ruby-identifier">$pixels_per_ex</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">render_png</span>(<span class="ruby-value">:inline</span>, <span class="ruby-string">&quot;x&quot;</span>).<span class="ruby-identifier">height</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- pixels_per_ex-source -->
          
        </div>

        

        
      </div><!-- pixels_per_ex-method -->

    
      <div id="method-i-render_footnotes" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">render_footnotes</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="render_footnotes-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 280</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">render_footnotes</span>
  <span class="ruby-identifier">div</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;div&#39;</span>)
  <span class="ruby-identifier">div</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-string">&#39;footnotes&#39;</span>
  <span class="ruby-identifier">div</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;hr&#39;</span>)
  <span class="ruby-identifier">ol</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;ol&#39;</span>)

  <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">footnotes_order</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">fid</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">num</span> = <span class="ruby-identifier">i</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">f</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">footnotes</span>[<span class="ruby-identifier">fid</span>]
      <span class="ruby-identifier">li</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;li&#39;</span>)
      <span class="ruby-identifier">li</span>[<span class="ruby-string">&#39;id&#39;</span>] = <span class="ruby-node">&quot;#{get_setting(:doc_prefix)}fn:#{num}&quot;</span>

      <span class="ruby-identifier">a</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;a&#39;</span>)
      <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;href&#39;</span>] = <span class="ruby-node">&quot;\##{get_setting(:doc_prefix)}fnref:#{num}&quot;</span>
      <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;rev&#39;</span>] = <span class="ruby-string">&#39;footnote&#39;</span>
      <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>([<span class="ruby-value">8617</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-string">&#39;U*&#39;</span>))

      <span class="ruby-identifier">last</span> = <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">li</span>.<span class="ruby-identifier">children</span>.<span class="ruby-identifier">reverse_each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">child</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">child</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">HTMLElement</span>)
          <span class="ruby-identifier">last</span> = <span class="ruby-identifier">child</span>
          <span class="ruby-keyword">break</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">last</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">last</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;p&quot;</span>
        <span class="ruby-identifier">last</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-string">&#39; &#39;</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">a</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">li</span>.<span class="ruby-identifier">children</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">a</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">ol</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">li</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Could not find footnote id &#39;#{fid}&#39; among [#{self.footnotes.keys.inspect}].&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">div</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ol</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- render_footnotes-source -->
          
        </div>

        

        
      </div><!-- render_footnotes-method -->

    
      <div id="method-i-render_mathml" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">render_mathml</span><span
            class="method-args">(kind, tex)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates an xml Mathml document of this node&#39;s TeX code.</p>

<p>@return [MaRuKu::Out::HTML::HTMLElement]</p>
          
          

          
          <div class="method-source-code" id="render_mathml-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/to_html.rb, line 47</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">render_mathml</span>(<span class="ruby-identifier">kind</span>, <span class="ruby-identifier">tex</span>)
  <span class="ruby-identifier">engine</span> = <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:html_math_engine</span>)
  <span class="ruby-identifier">method</span> = <span class="ruby-node">&quot;convert_to_mathml_#{engine}&quot;</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-identifier">method</span>
    <span class="ruby-identifier">mathml</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">kind</span>, <span class="ruby-identifier">tex</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">mathml</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">convert_to_mathml_none</span>(<span class="ruby-identifier">kind</span>, <span class="ruby-identifier">tex</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># TODO: Warn here</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;A method called #{method} should be defined.&quot;</span>
  <span class="ruby-identifier">convert_to_mathml_none</span>(<span class="ruby-identifier">kind</span>, <span class="ruby-identifier">tex</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- render_mathml-source -->
          
        </div>

        

        
      </div><!-- render_mathml-method -->

    
      <div id="method-i-render_png" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">render_png</span><span
            class="method-args">(kind, tex)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Renders a <a href="HTML.html#PNG">PNG</a> image of this node&#39;s TeX
code. Returns</p>

<p>@return [MaRuKu::Out::HTML::PNG, nil]</p>

<pre>A struct describing the location and size of the image,
or nil if no library is loaded that can render PNGs.</pre>
          
          

          
          <div class="method-source-code" id="render_png-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/to_html.rb, line 66</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">render_png</span>(<span class="ruby-identifier">kind</span>, <span class="ruby-identifier">tex</span>)
  <span class="ruby-identifier">engine</span> = <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:html_png_engine</span>)
  <span class="ruby-identifier">method</span> = <span class="ruby-node">&quot;convert_to_png_#{engine}&quot;</span>.<span class="ruby-identifier">to_sym</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">kind</span>, <span class="ruby-identifier">tex</span>) <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-identifier">method</span>

  <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;A method called #{method} should be defined.&quot;</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- render_png-source -->
          
        </div>

        

        
      </div><!-- render_png-method -->

    
      <div id="method-i-render_section_number" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">render_section_number</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>nil if not applicable, else SPAN element</p>
          
          

          
          <div class="method-source-code" id="render_section_number-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 465</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">render_section_number</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">section_number</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">section_number</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-comment"># if we are bound to a section, add section number</span>
  <span class="ruby-identifier">span</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;span&#39;</span>)
  <span class="ruby-identifier">span</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-string">&#39;maruku_section_number&#39;</span>
  <span class="ruby-identifier">span</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-identifier">section_number</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- render_section_number-source -->
          
        </div>

        

        
      </div><!-- render_section_number-method -->

    
      <div id="method-i-section_number" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">section_number</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>nil if not applicable, else string</p>
          
          

          
          <div class="method-source-code" id="section_number-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 455</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">section_number</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:use_numbered_headers</span>)

  <span class="ruby-identifier">n</span> = <span class="ruby-constant">Array</span>(<span class="ruby-ivar">@attributes</span>[<span class="ruby-value">:section_number</span>])
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">n</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-identifier">n</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39;.&#39;</span>) <span class="ruby-operator">+</span> <span class="ruby-string">&quot;. &quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- section_number-source -->
          
        </div>

        

        
      </div><!-- section_number-method -->

    
      <div id="method-i-to_html" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html</span><span
            class="method-args">(context={})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Render as an <a href="HTML.html">HTML</a> fragment (no head, just the
content of BODY). (returns a string)</p>
          
          

          
          <div class="method-source-code" id="to_html-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 68</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html</span>(<span class="ruby-identifier">context</span>={})
  <span class="ruby-identifier">output</span> = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-identifier">children_to_html</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># render footnotes</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">footnotes_order</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">render_footnotes</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">output</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html-source -->
          
        </div>

        

        
      </div><!-- to_html-method -->

    
      <div id="method-i-to_html_abbr" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_abbr</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_abbr-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 756</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_abbr</span>
  <span class="ruby-identifier">abbr</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;abbr&#39;</span>)
  <span class="ruby-identifier">abbr</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-identifier">children</span>[<span class="ruby-value">0</span>])
  <span class="ruby-identifier">abbr</span>[<span class="ruby-string">&#39;title&#39;</span>] = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">title</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">title</span>
  <span class="ruby-identifier">abbr</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_abbr-source -->
          
        </div>

        

        
      </div><!-- to_html_abbr-method -->

    
      <div id="method-i-to_html_cell" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_cell</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_cell-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 837</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_cell</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@attributes</span>[<span class="ruby-value">:scope</span>]
    <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;th&#39;</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;td&#39;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_cell-source -->
          
        </div>

        

        
      </div><!-- to_html_cell-method -->

    
      <div id="method-i-to_html_code" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_code</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_code-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 519</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_code</span>
  <span class="ruby-identifier">source</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">raw_code</span>

  <span class="ruby-identifier">code_lang</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">lang</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">attributes</span>[<span class="ruby-value">:lang</span>] <span class="ruby-operator">||</span> <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">attributes</span>[<span class="ruby-value">:code_lang</span>]

  <span class="ruby-identifier">code_lang</span> = <span class="ruby-string">&#39;xml&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">code_lang</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;html&#39;</span>
  <span class="ruby-identifier">code_lang</span> = <span class="ruby-string">&#39;css21&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">code_lang</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;css&#39;</span>

  <span class="ruby-identifier">use_syntax</span> = <span class="ruby-identifier">get_setting</span> <span class="ruby-value">:html_use_syntax</span>

  <span class="ruby-identifier">element</span> =
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_syntax</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">code_lang</span>
      <span class="ruby-keyword">begin</span>
        <span class="ruby-keyword">unless</span> <span class="ruby-identifier">$syntax_loaded</span>
          <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;rubygems&#39;</span>
          <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;syntax&#39;</span>
          <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;syntax/convertors/html&#39;</span>
          <span class="ruby-identifier">$syntax_loaded</span> = <span class="ruby-keyword">true</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">convertor</span> = <span class="ruby-constant">Syntax</span><span class="ruby-operator">::</span><span class="ruby-constant">Convertors</span><span class="ruby-operator">::</span><span class="ruby-constant">HTML</span>.<span class="ruby-identifier">for_syntax</span> <span class="ruby-identifier">code_lang</span>

        <span class="ruby-comment"># eliminate trailing newlines otherwise Syntax crashes</span>
        <span class="ruby-identifier">source</span> = <span class="ruby-identifier">source</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/\n*\z/</span>, <span class="ruby-string">&#39;&#39;</span>)

        <span class="ruby-identifier">html</span> = <span class="ruby-identifier">convertor</span>.<span class="ruby-identifier">convert</span>(<span class="ruby-identifier">source</span>)

        <span class="ruby-identifier">html</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/\&amp;apos;|&#39;/</span>,<span class="ruby-string">&#39;&amp;#39;&#39;</span>) <span class="ruby-comment"># IE bug</span>

        <span class="ruby-identifier">d</span> = <span class="ruby-constant">MaRuKu</span><span class="ruby-operator">::</span><span class="ruby-constant">HTMLFragment</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">html</span>)
        <span class="ruby-identifier">highlighted</span> = <span class="ruby-identifier">d</span>.<span class="ruby-identifier">to_html</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/\A&lt;pre&gt;(.*)&lt;\/pre&gt;\z/</span>, <span class="ruby-string">&#39;\1&#39;</span>)
        <span class="ruby-identifier">code</span> = <span class="ruby-constant">HTMLElement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;code&#39;</span>, { <span class="ruby-value">:class</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">code_lang</span> }, <span class="ruby-identifier">highlighted</span>)

        <span class="ruby-identifier">pre</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;pre&#39;</span>)
        <span class="ruby-comment"># add a class here, too, for compatibility with existing implementations</span>
        <span class="ruby-identifier">pre</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-identifier">code_lang</span>
        <span class="ruby-identifier">pre</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">code</span>
        <span class="ruby-identifier">pre</span>
      <span class="ruby-keyword">rescue</span> <span class="ruby-constant">LoadError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
        <span class="ruby-identifier">maruku_error</span> <span class="ruby-string">&quot;Could not load package &#39;syntax&#39;.\n&quot;</span> <span class="ruby-operator">+</span>
          <span class="ruby-string">&quot;Please install it, for example using &#39;gem install syntax&#39;.&quot;</span>
        <span class="ruby-identifier">to_html_code_using_pre</span>(<span class="ruby-identifier">source</span>, <span class="ruby-identifier">code_lang</span>)
      <span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
        <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Error while using the syntax library for code:\n#{source.inspect}&quot;</span> <span class="ruby-operator">+</span>
          <span class="ruby-node">&quot;Lang is #{code_lang} object is: \n&quot;</span> <span class="ruby-operator">+</span>
          <span class="ruby-keyword">self</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-operator">+</span>
          <span class="ruby-node">&quot;\nException: #{e.class}: #{e.message}&quot;</span>

        <span class="ruby-identifier">tell_user</span>(<span class="ruby-string">&quot;Using normal PRE because the syntax library did not work.&quot;</span>)
        <span class="ruby-identifier">to_html_code_using_pre</span>(<span class="ruby-identifier">source</span>, <span class="ruby-identifier">code_lang</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">to_html_code_using_pre</span>(<span class="ruby-identifier">source</span>, <span class="ruby-identifier">code_lang</span>)
    <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">color</span> = <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:code_background_color</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">color</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">MaRuKu</span><span class="ruby-operator">::</span><span class="ruby-constant">Globals</span>[<span class="ruby-value">:code_background_color</span>]
    <span class="ruby-identifier">element</span>[<span class="ruby-string">&#39;style&#39;</span>] = <span class="ruby-node">&quot;background-color: #{color};&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">add_ws</span> <span class="ruby-identifier">element</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_code-source -->
          
        </div>

        

        
      </div><!-- to_html_code-method -->

    
      <div id="method-i-to_html_code_using_pre" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_code_using_pre</span><span
            class="method-args">(source, code_lang=nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <h1 id="method-i-to_html_code_using_pre-label-begin+maruku_doc">begin maruku_doc<span><a href="#method-i-to_html_code_using_pre-label-begin+maruku_doc">&para;</a> <a href="#documentation">&uarr;</a></span></h1>

<pre>Attribute: code_background_color
Scope: global, document, element
Summary: Background color for code blocks.

The format is either a named color (`green`, `red`) or a CSS color
of the form `#ff00ff`.

* for **HTML output**, the value is put straight in the `background-color` CSS
  property of the block.

* for **LaTeX output**, if it is a named color, it must be a color accepted
  by the LaTeX `color` packages. If it is of the form `#ff00ff`, Maruku
  defines a color using the `\color[rgb]{r,g,b}` macro.

  For example, for `#0000ff`, the macro is called as: `\color[rgb]{0,0,1}`.</pre>

<h1 id="method-i-to_html_code_using_pre-label-end">end<span><a href="#method-i-to_html_code_using_pre-label-end">&para;</a> <a href="#documentation">&uarr;</a></span></h1>
          
          

          
          <div class="method-source-code" id="to_html_code_using_pre-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 600</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_code_using_pre</span>(<span class="ruby-identifier">source</span>, <span class="ruby-identifier">code_lang</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">code</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;code&#39;</span>)
  <span class="ruby-identifier">pre</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;pre&#39;</span>)
  <span class="ruby-identifier">pre</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">code</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:code_show_spaces</span>)
    <span class="ruby-comment"># 187 = raquo</span>
    <span class="ruby-comment"># 160 = nbsp</span>
    <span class="ruby-comment"># 172 = not</span>
    <span class="ruby-identifier">source</span> = <span class="ruby-identifier">source</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/\t/</span>,<span class="ruby-string">&#39;&amp;#187;&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;&amp;#160;&#39;</span> <span class="ruby-operator">*</span> <span class="ruby-value">3</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/ /</span>,<span class="ruby-string">&#39;&amp;#172;&#39;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">code</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-identifier">source</span>)

  <span class="ruby-identifier">code_lang</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">attributes</span>[<span class="ruby-value">:lang</span>]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">code_lang</span>
    <span class="ruby-identifier">pre</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-identifier">code</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-identifier">code_lang</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">pre</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_code_using_pre-source -->
          
        </div>

        

        
      </div><!-- to_html_code_using_pre-method -->

    
      <div id="method-i-to_html_definition" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_definition</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_definition-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 793</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_definition</span>
  <span class="ruby-identifier">children_to_html</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_definition-source -->
          
        </div>

        

        
      </div><!-- to_html_definition-method -->

    
      <div id="method-i-to_html_definition_data" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_definition_data</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_definition_data-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 801</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_definition_data</span>
  <span class="ruby-identifier">add_ws</span> <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;dd&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_definition_data-source -->
          
        </div>

        

        
      </div><!-- to_html_definition_data-method -->

    
      <div id="method-i-to_html_definition_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_definition_list</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Definition lists ###</p>
          
          

          
          <div class="method-source-code" id="to_html_definition_list-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 789</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_definition_list</span>
  <span class="ruby-identifier">add_ws</span> <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;dl&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_definition_list-source -->
          
        </div>

        

        
      </div><!-- to_html_definition_list-method -->

    
      <div id="method-i-to_html_definition_term" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_definition_term</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_definition_term-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 797</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_definition_term</span>
  <span class="ruby-identifier">add_ws</span> <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;dt&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_definition_term-source -->
          
        </div>

        

        
      </div><!-- to_html_definition_term-method -->

    
      <div id="method-i-to_html_div" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_div</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_div-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/div.rb, line 120</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_div</span>
  <span class="ruby-identifier">add_ws</span> <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;div&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_div-source -->
          
        </div>

        

        
      </div><!-- to_html_div-method -->

    
      <div id="method-i-to_html_divref" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_divref</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_divref-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/to_html.rb, line 162</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_divref</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">hash</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">doc</span>.<span class="ruby-identifier">refid2ref</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">find</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">refid</span>)}
    <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Cannot find div #{self.refid.inspect}&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-node">&quot;\\ref{#{self.refid}}&quot;</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">ref</span>= <span class="ruby-identifier">hash</span>[<span class="ruby-keyword">self</span>.<span class="ruby-identifier">refid</span>]

  <span class="ruby-identifier">a</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;a&#39;</span>)
  <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-string">&#39;maruku-ref&#39;</span>
  <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;href&#39;</span>] = <span class="ruby-node">&quot;#&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">refid</span>
  <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-identifier">ref</span>.<span class="ruby-identifier">num</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-identifier">a</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_divref-source -->
          
        </div>

        

        
      </div><!-- to_html_divref-method -->

    
      <div id="method-i-to_html_document" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_document</span><span
            class="method-args">(context={})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Render to a complete <a href="HTML.html">HTML</a> document (returns a
string)</p>
          
          

          
          <div class="method-source-code" id="to_html_document-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 90</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_document</span>(<span class="ruby-identifier">context</span>={})
  <span class="ruby-identifier">doc</span> = <span class="ruby-identifier">to_html_document_tree</span>

  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-constant">Xhtml11_mathml2_svg11</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">xml</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_document-source -->
          
        </div>

        

        
      </div><!-- to_html_document-method -->

    
      <div id="method-i-to_html_document_tree" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_document_tree</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Render to a complete <a href="HTML.html">HTML</a> document (returns an <a
href="HTML/HTMLElement.html">HTMLElement</a> document tree)</p>
          
          

          
          <div class="method-source-code" id="to_html_document_tree-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 164</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_document_tree</span>
  <span class="ruby-identifier">root</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;html&#39;</span>)
  <span class="ruby-identifier">root</span>[<span class="ruby-string">&#39;xmlns&#39;</span>] = <span class="ruby-string">&#39;http://www.w3.org/1999/xhtml&#39;</span>
  <span class="ruby-identifier">root</span>[<span class="ruby-string">&#39;xmlns:svg&#39;</span>] = <span class="ruby-string">&quot;http://www.w3.org/2000/svg&quot;</span>
  <span class="ruby-identifier">root</span>[<span class="ruby-string">&#39;xml:lang&#39;</span>] = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">attributes</span>[<span class="ruby-value">:lang</span>] <span class="ruby-operator">||</span> <span class="ruby-string">&#39;en&#39;</span>

  <span class="ruby-identifier">root</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xml_newline</span>
  <span class="ruby-identifier">head</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;head&#39;</span>)
  <span class="ruby-identifier">root</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">head</span>

  <span class="ruby-comment">#&lt;META HTTP-EQUIV=&quot;Content-Type&quot; CONTENT=&quot;text/html; charset=utf-8&quot;&gt;</span>
  <span class="ruby-identifier">me</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;meta&#39;</span>)
  <span class="ruby-identifier">me</span>[<span class="ruby-string">&#39;http-equiv&#39;</span>] = <span class="ruby-string">&#39;Content-type&#39;</span>
  <span class="ruby-identifier">me</span>[<span class="ruby-string">&#39;content&#39;</span>] = <span class="ruby-string">&#39;application/xhtml+xml;charset=utf-8&#39;</span>
  <span class="ruby-identifier">head</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">me</span>

  <span class="ruby-node">%w(description keywords author revised)</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">m</span>.<span class="ruby-identifier">to_sym</span>]
      <span class="ruby-identifier">meta</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;meta&#39;</span>)
      <span class="ruby-identifier">meta</span>[<span class="ruby-string">&#39;name&#39;</span>] = <span class="ruby-identifier">m</span>
      <span class="ruby-identifier">meta</span>[<span class="ruby-string">&#39;content&#39;</span>] = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">head</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">meta</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\Ameta-(.*)\z/</span>
      <span class="ruby-identifier">meta</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;meta&#39;</span>)
      <span class="ruby-identifier">meta</span>[<span class="ruby-string">&#39;name&#39;</span>] = <span class="ruby-node">$1</span>
      <span class="ruby-identifier">meta</span>[<span class="ruby-string">&#39;content&#39;</span>] = <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">head</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">meta</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Create title element</span>
  <span class="ruby-identifier">doc_title</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">attributes</span>[<span class="ruby-value">:title</span>] <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">attributes</span>[<span class="ruby-value">:subject</span>] <span class="ruby-operator">||</span> <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">title_content</span> = <span class="ruby-constant">MaRuKu</span><span class="ruby-operator">::</span><span class="ruby-constant">HTMLFragment</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">doc_title</span>).<span class="ruby-identifier">to_html</span>
  <span class="ruby-keyword">rescue</span>
    <span class="ruby-identifier">title_content</span> = <span class="ruby-identifier">xtext</span>(<span class="ruby-identifier">doc_title</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">title</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;title&#39;</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">title_content</span>
  <span class="ruby-identifier">head</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">title</span>
  <span class="ruby-identifier">add_css_to</span>(<span class="ruby-identifier">head</span>)

  <span class="ruby-identifier">root</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xml_newline</span>

  <span class="ruby-identifier">body</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;body&#39;</span>)

  <span class="ruby-identifier">children_to_html</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># render footnotes</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">footnotes_order</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">render_footnotes</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># When we are rendering a whole document, we add a signature</span>
  <span class="ruby-comment"># at the bottom.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:maruku_signature</span>)
    <span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">maruku_html_signature</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">root</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">body</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_document_tree-source -->
          
        </div>

        

        
      </div><!-- to_html_document_tree-method -->

    
      <div id="method-i-to_html_email_address" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_email_address</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_email_address-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 694</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_email_address</span>
  <span class="ruby-identifier">obfuscated</span> = <span class="ruby-identifier">obfuscate</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">email</span>)
  <span class="ruby-identifier">html_element</span>(<span class="ruby-string">&#39;a&#39;</span>, <span class="ruby-identifier">obfuscated</span>, <span class="ruby-value">:href</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;mailto:#{obfuscated}&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_email_address-source -->
          
        </div>

        

        
      </div><!-- to_html_email_address-method -->

    
      <div id="method-i-to_html_emphasis" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_emphasis</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_emphasis-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 439</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_emphasis</span>
  <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;em&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_emphasis-source -->
          
        </div>

        

        
      </div><!-- to_html_emphasis-method -->

    
      <div id="method-i-to_html_entity" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_entity</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_entity-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 845</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_entity</span>
  <span class="ruby-identifier">entity_name</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">entity_name</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">entity</span> = <span class="ruby-constant">MaRuKu</span><span class="ruby-operator">::</span><span class="ruby-constant">Out</span><span class="ruby-operator">::</span><span class="ruby-constant">EntityTable</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">entity</span>(<span class="ruby-identifier">entity_name</span>)
    <span class="ruby-identifier">entity_name</span> = <span class="ruby-identifier">entity</span>.<span class="ruby-identifier">html_num</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">entity_name</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Fixnum</span>
    <span class="ruby-comment"># Convert numeric entities to unicode characters</span>
    <span class="ruby-identifier">xtext</span>([<span class="ruby-identifier">entity_name</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-string">&#39;U*&#39;</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-node">&quot;&amp;#{entity_name};&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_entity-source -->
          
        </div>

        

        
      </div><!-- to_html_entity-method -->

    
      <div id="method-i-to_html_eqref" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_eqref</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_eqref-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/to_html.rb, line 149</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_eqref</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">eq</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">doc</span>.<span class="ruby-identifier">eqid2eq</span>[<span class="ruby-keyword">self</span>.<span class="ruby-identifier">eqid</span>]
    <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Cannot find equation #{self.eqid.inspect}&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-node">&quot;(eq:#{self.eqid})&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">a</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;a&#39;</span>)
  <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-string">&#39;maruku-eqref&#39;</span>
  <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;href&#39;</span>] = <span class="ruby-node">&quot;#eq:#{self.eqid}&quot;</span>
  <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-node">&quot;(#{eq.num})&quot;</span>)
  <span class="ruby-identifier">a</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_eqref-source -->
          
        </div>

        

        
      </div><!-- to_html_eqref-method -->

    
      <div id="method-i-to_html_equation" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_equation</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_equation-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/to_html.rb, line 116</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_equation</span>
  <span class="ruby-identifier">mathml</span> = <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:html_math_output_mathml</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">render_mathml</span>(<span class="ruby-value">:equation</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">math</span>)
  <span class="ruby-identifier">png</span>    = <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:html_math_output_png</span>)    <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">render_png</span>(<span class="ruby-value">:equation</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">math</span>)

  <span class="ruby-identifier">div</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;div&#39;</span>)
  <span class="ruby-identifier">div</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-string">&#39;maruku-equation&#39;</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">mathml</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">label</span>  <span class="ruby-comment"># then numerate</span>
      <span class="ruby-identifier">span</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;span&#39;</span>)
      <span class="ruby-identifier">span</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-string">&#39;maruku-eq-number&#39;</span>
      <span class="ruby-identifier">span</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-node">&quot;(#{self.num})&quot;</span>)
      <span class="ruby-identifier">div</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">span</span>
      <span class="ruby-identifier">div</span>[<span class="ruby-string">&#39;id&#39;</span>] = <span class="ruby-node">&quot;eq:#{self.label}&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">mathml</span>.<span class="ruby-identifier">add_class</span>(<span class="ruby-string">&#39;maruku-mathml&#39;</span>)
    <span class="ruby-identifier">div</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">mathml</span>.<span class="ruby-identifier">to_html</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">png</span>
    <span class="ruby-identifier">img</span> = <span class="ruby-identifier">adjust_png</span>(<span class="ruby-identifier">png</span>, <span class="ruby-keyword">false</span>)
    <span class="ruby-identifier">div</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">img</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">label</span>  <span class="ruby-comment"># then numerate</span>
      <span class="ruby-identifier">span</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;span&#39;</span>)
      <span class="ruby-identifier">span</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-string">&#39;maruku-eq-number&#39;</span>
      <span class="ruby-identifier">span</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-node">&quot;(#{self.num})&quot;</span>)
      <span class="ruby-identifier">div</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">span</span>
      <span class="ruby-identifier">div</span>[<span class="ruby-string">&#39;id&#39;</span>] = <span class="ruby-node">&quot;eq:#{self.label}&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">div</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_equation-source -->
          
        </div>

        

        
      </div><!-- to_html_equation-method -->

    
      <div id="method-i-to_html_footnote_reference" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_footnote_reference</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_footnote_reference-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 763</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_footnote_reference</span>
  <span class="ruby-identifier">id</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">footnote_id</span>

  <span class="ruby-comment"># save the order of used footnotes</span>
  <span class="ruby-identifier">order</span> = <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">footnotes_order</span>

  <span class="ruby-comment"># footnote has already been used</span>
  <span class="ruby-keyword">return</span> [] <span class="ruby-keyword">if</span> <span class="ruby-identifier">order</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">id</span>)

  <span class="ruby-keyword">return</span> [] <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">footnotes</span>[<span class="ruby-identifier">id</span>]

  <span class="ruby-comment"># take next number</span>
  <span class="ruby-identifier">order</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">id</span>

  <span class="ruby-identifier">num</span> = <span class="ruby-identifier">order</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">id</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>

  <span class="ruby-identifier">sup</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;sup&#39;</span>)
  <span class="ruby-identifier">sup</span>[<span class="ruby-string">&#39;id&#39;</span>] = <span class="ruby-node">&quot;#{get_setting(:doc_prefix)}fnref:#{num}&quot;</span>
  <span class="ruby-identifier">a</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;a&#39;</span>)
  <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-identifier">num</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;href&#39;</span>] = <span class="ruby-node">&quot;\##{get_setting(:doc_prefix)}fn:#{num}&quot;</span>
  <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;rel&#39;</span>] = <span class="ruby-string">&#39;footnote&#39;</span>
  <span class="ruby-identifier">sup</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">a</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_footnote_reference-source -->
          
        </div>

        

        
      </div><!-- to_html_footnote_reference-method -->

    
      <div id="method-i-to_html_head_cell" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_head_cell</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_head_cell-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 833</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_head_cell</span>
  <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;th&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_head_cell-source -->
          
        </div>

        

        
      </div><!-- to_html_head_cell-method -->

    
      <div id="method-i-to_html_header" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_header</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_header-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 474</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_header</span>
  <span class="ruby-identifier">element_name</span> = <span class="ruby-node">&quot;h#{self.level}&quot;</span>
  <span class="ruby-identifier">h</span> = <span class="ruby-identifier">wrap_as_element</span> <span class="ruby-identifier">element_name</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">span</span> = <span class="ruby-identifier">render_section_number</span>
    <span class="ruby-identifier">h</span>.<span class="ruby-identifier">children</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-identifier">span</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">add_ws</span> <span class="ruby-identifier">h</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_header-source -->
          
        </div>

        

        
      </div><!-- to_html_header-method -->

    
      <div id="method-i-to_html_hrule" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_hrule</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_hrule-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 319</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_hrule</span>
  <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;hr&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_hrule-source -->
          
        </div>

        

        
      </div><!-- to_html_hrule-method -->

    
      <div id="method-i-to_html_im_image" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_im_image</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_im_image-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 717</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_im_image</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">url</span>
    <span class="ruby-identifier">attrs</span> = {}
    <span class="ruby-identifier">attrs</span>[<span class="ruby-string">&#39;src&#39;</span>] = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">url</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">attrs</span>[<span class="ruby-string">&#39;alt&#39;</span>] = <span class="ruby-identifier">children_to_s</span>
    <span class="ruby-identifier">attrs</span>[<span class="ruby-string">&#39;title&#39;</span>] = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">title</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">title</span>
    <span class="ruby-identifier">html_element</span>(<span class="ruby-string">&#39;img&#39;</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">attrs</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Image with no url: #{self.inspect}&quot;</span>
    <span class="ruby-identifier">tell_user</span> <span class="ruby-string">&quot;Could not create image without a source URL;&quot;</span> <span class="ruby-operator">+</span>
      <span class="ruby-string">&quot; Using SPAN element as replacement.&quot;</span>
    <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;span&#39;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_im_image-source -->
          
        </div>

        

        
      </div><!-- to_html_im_image-method -->

    
      <div id="method-i-to_html_im_link" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_im_link</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_im_link-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 669</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_im_link</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">url</span>
    <span class="ruby-identifier">a</span> = {}
    <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;href&#39;</span>] = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">url</span>
    <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;title&#39;</span>] = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">title</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">title</span>
    <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;a&#39;</span>, <span class="ruby-identifier">a</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Could not find url in #{self.inspect}&quot;</span>
    <span class="ruby-identifier">tell_user</span> <span class="ruby-node">&quot;Not creating a link for ref_id = #{id.inspect}.&quot;</span>
    <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;span&#39;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_im_link-source -->
          
        </div>

        

        
      </div><!-- to_html_im_link-method -->

    
      <div id="method-i-to_html_image" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_image</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Images</p>
          
          

          
          <div class="method-source-code" id="to_html_image-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 701</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_image</span>
  <span class="ruby-identifier">a</span> = {}
  <span class="ruby-identifier">id</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">ref_id</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">ref</span> = <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">refs</span>[<span class="ruby-identifier">sanitize_ref_id</span>(<span class="ruby-identifier">id</span>)] <span class="ruby-operator">||</span> <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">refs</span>[<span class="ruby-identifier">sanitize_ref_id</span>(<span class="ruby-identifier">children_to_s</span>)]
    <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;src&#39;</span>] = <span class="ruby-identifier">ref</span>[<span class="ruby-value">:url</span>].<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;alt&#39;</span>] = <span class="ruby-identifier">children_to_s</span>
    <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;title&#39;</span>] = <span class="ruby-identifier">ref</span>[<span class="ruby-value">:title</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">ref</span>[<span class="ruby-value">:title</span>]
    <span class="ruby-identifier">html_element</span>(<span class="ruby-string">&#39;img&#39;</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">a</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Could not find id = #{id.inspect} for\n #{self.inspect}&quot;</span>
    <span class="ruby-identifier">tell_user</span> <span class="ruby-node">&quot;Could not create image with ref_id = #{id.inspect};&quot;</span> <span class="ruby-operator">+</span>
      <span class="ruby-string">&quot; Using SPAN element as replacement.&quot;</span>
    <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;span&#39;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_image-source -->
          
        </div>

        

        
      </div><!-- to_html_image-method -->

    
      <div id="method-i-to_html_immediate_link" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_immediate_link</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_immediate_link-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 643</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_immediate_link</span>
  <span class="ruby-identifier">text</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">url</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/^mailto:/</span>, <span class="ruby-string">&#39;&#39;</span>) <span class="ruby-comment"># don&#39;t show mailto</span>
  <span class="ruby-identifier">html_element</span>(<span class="ruby-string">&#39;a&#39;</span>, <span class="ruby-identifier">text</span>, <span class="ruby-string">&#39;href&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">url</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_immediate_link-source -->
          
        </div>

        

        
      </div><!-- to_html_immediate_link-method -->

    
      <div id="method-i-to_html_inline_code" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_inline_code</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_inline_code-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 622</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_inline_code</span>
  <span class="ruby-identifier">code_attrs</span> = {}
  <span class="ruby-identifier">source</span> = <span class="ruby-identifier">xtext</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">raw_code</span>)

  <span class="ruby-identifier">color</span> = <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:code_background_color</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">color</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">MaRuKu</span><span class="ruby-operator">::</span><span class="ruby-constant">Globals</span>[<span class="ruby-value">:code_background_color</span>]
    <span class="ruby-identifier">code_attrs</span>[<span class="ruby-string">&#39;style&#39;</span>] = <span class="ruby-node">&quot;background-color: #{color};&quot;</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">code_attrs</span>[<span class="ruby-string">&#39;style&#39;</span>] <span class="ruby-operator">||</span> <span class="ruby-string">&quot;&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">html_element</span>(<span class="ruby-string">&#39;code&#39;</span>, <span class="ruby-identifier">source</span>, <span class="ruby-identifier">code_attrs</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_inline_code-source -->
          
        </div>

        

        
      </div><!-- to_html_inline_code-method -->

    
      <div id="method-i-to_html_inline_math" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_inline_math</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_inline_math-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/to_html.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_inline_math</span>
  <span class="ruby-identifier">mathml</span> = <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:html_math_output_mathml</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">render_mathml</span>(<span class="ruby-value">:inline</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">math</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">mathml</span>
    <span class="ruby-identifier">mathml</span>.<span class="ruby-identifier">add_class</span>(<span class="ruby-string">&#39;maruku-mathml&#39;</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">mathml</span>.<span class="ruby-identifier">to_html</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">png</span> = <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:html_math_output_png</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">render_png</span>(<span class="ruby-value">:inline</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">math</span>)

  <span class="ruby-constant">HTMLElement</span>.<span class="ruby-identifier">new</span> <span class="ruby-string">&#39;span&#39;</span>, <span class="ruby-string">&#39;class&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;maruku-inline&#39;</span> <span class="ruby-keyword">do</span>
    <span class="ruby-comment"># TODO: It seems weird that we output an empty span if there&#39;s no PNG</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">png</span>
      <span class="ruby-identifier">adjust_png</span>(<span class="ruby-identifier">png</span>, <span class="ruby-keyword">true</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_inline_math-source -->
          
        </div>

        

        
      </div><!-- to_html_inline_math-method -->

    
      <div id="method-i-to_html_li" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_li</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_li-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 427</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_li</span>
  <span class="ruby-identifier">add_ws</span> <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;li&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_li-source -->
          
        </div>

        

        
      </div><!-- to_html_li-method -->

    
      <div id="method-i-to_html_linebreak" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_linebreak</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_linebreak-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 323</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_linebreak</span>
  <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;br&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_linebreak-source -->
          
        </div>

        

        
      </div><!-- to_html_linebreak-method -->

    
      <div id="method-i-to_html_link" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_link</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_link-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 648</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_link</span>
  <span class="ruby-identifier">a</span> = {}
  <span class="ruby-identifier">id</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">ref_id</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">children_to_s</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">ref</span> = <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">refs</span>[<span class="ruby-identifier">sanitize_ref_id</span>(<span class="ruby-identifier">id</span>)] <span class="ruby-operator">||</span> <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">refs</span>[<span class="ruby-identifier">sanitize_ref_id</span>(<span class="ruby-identifier">children_to_s</span>)]
    <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;href&#39;</span>] = <span class="ruby-identifier">ref</span>[<span class="ruby-value">:url</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">ref</span>[<span class="ruby-value">:url</span>]
    <span class="ruby-identifier">a</span>[<span class="ruby-string">&#39;title&#39;</span>] = <span class="ruby-identifier">ref</span>[<span class="ruby-value">:title</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">ref</span>[<span class="ruby-value">:title</span>]
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">maruku_error</span> <span class="ruby-node">&quot;Could not find ref_id = #{id.inspect} for #{self.inspect}\n&quot;</span> <span class="ruby-operator">+</span>
      <span class="ruby-node">&quot;Available refs are #{@doc.refs.keys.inspect}&quot;</span>
    <span class="ruby-identifier">tell_user</span> <span class="ruby-node">&quot;Not creating a link for ref_id = #{id.inspect}.\n&quot;</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">ref_id</span>)
      <span class="ruby-keyword">return</span> <span class="ruby-node">&quot;[#{children_to_s}][#{id}]&quot;</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">return</span> <span class="ruby-node">&quot;[#{children_to_s}]&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;a&#39;</span>, <span class="ruby-identifier">a</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_link-source -->
          
        </div>

        

        
      </div><!-- to_html_link-method -->

    
      <div id="method-i-to_html_ol" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_ol</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_ol-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 423</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_ol</span>
  <span class="ruby-identifier">add_ws</span> <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;ol&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_ol-source -->
          
        </div>

        

        
      </div><!-- to_html_ol-method -->

    
      <div id="method-i-to_html_paragraph" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_paragraph</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_paragraph-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 419</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_paragraph</span>
  <span class="ruby-identifier">add_ws</span> <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;p&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_paragraph-source -->
          
        </div>

        

        
      </div><!-- to_html_paragraph-method -->

    
      <div id="method-i-to_html_quote" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_quote</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_quote-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 431</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_quote</span>
  <span class="ruby-identifier">add_ws</span> <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;blockquote&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_quote-source -->
          
        </div>

        

        
      </div><!-- to_html_quote-method -->

    
      <div id="method-i-to_html_raw_html" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_raw_html</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <h1 id="method-i-to_html_raw_html-label-begin+maruku_doc">begin maruku_doc<span><a href="#method-i-to_html_raw_html-label-begin+maruku_doc">&para;</a> <a href="#documentation">&uarr;</a></span></h1>

<pre>Attribute: filter_html
Scope: document

If true, raw HTML is discarded from the output.</pre>

<h1 id="method-i-to_html_raw_html-label-end">end<span><a href="#method-i-to_html_raw_html-label-end">&para;</a> <a href="#documentation">&uarr;</a></span></h1>
          
          

          
          <div class="method-source-code" id="to_html_raw_html-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 740</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_raw_html</span>
  <span class="ruby-keyword">return</span> [] <span class="ruby-keyword">if</span> <span class="ruby-identifier">get_setting</span>(<span class="ruby-value">:filter_html</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">parsed_html</span>.<span class="ruby-identifier">to_html</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">parsed_html</span>

  <span class="ruby-comment"># If there&#39;s no parsed HTML</span>
  <span class="ruby-identifier">raw_html</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">raw_html</span>

  <span class="ruby-comment"># Creates red box with offending HTML</span>
  <span class="ruby-identifier">tell_user</span> <span class="ruby-string">&quot;Wrapping bad html in a PRE with class &#39;markdown-html-error&#39;\n&quot;</span> <span class="ruby-operator">+</span>
    <span class="ruby-identifier">raw_html</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/^/</span>, <span class="ruby-string">&#39;|&#39;</span>)
  <span class="ruby-identifier">pre</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;pre&#39;</span>)
  <span class="ruby-identifier">pre</span>[<span class="ruby-string">&#39;style&#39;</span>] = <span class="ruby-string">&#39;border: solid 3px red; background-color: pink&#39;</span>
  <span class="ruby-identifier">pre</span>[<span class="ruby-string">&#39;class&#39;</span>] = <span class="ruby-string">&#39;markdown-html-error&#39;</span>
  <span class="ruby-identifier">pre</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-node">&quot;Maruku could not parse this XML/HTML: \n#{raw_html}&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_raw_html-source -->
          
        </div>

        

        
      </div><!-- to_html_raw_html-method -->

    
      <div id="method-i-to_html_ref_definition" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_ref_definition</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_ref_definition-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 908</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_ref_definition</span>
  []
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_ref_definition-source -->
          
        </div>

        

        
      </div><!-- to_html_ref_definition-method -->

    
      <div id="method-i-to_html_strong" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_strong</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_strong-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 435</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_strong</span>
  <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;strong&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_strong-source -->
          
        </div>

        

        
      </div><!-- to_html_strong-method -->

    
      <div id="method-i-to_html_table" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_table</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_table-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 805</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_table</span>
  <span class="ruby-identifier">num_columns</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">align</span>.<span class="ruby-identifier">size</span>

  <span class="ruby-comment"># The table data is passed as a multi-dimensional array</span>
  <span class="ruby-comment"># we just need to split the head from the body</span>
  <span class="ruby-identifier">head</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">rows</span> = <span class="ruby-ivar">@children</span>

  <span class="ruby-identifier">table</span> = <span class="ruby-identifier">html_element</span>(<span class="ruby-string">&#39;table&#39;</span>)
  <span class="ruby-identifier">thead</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;thead&#39;</span>)
  <span class="ruby-identifier">tr</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;tr&#39;</span>)
  <span class="ruby-identifier">array_to_html</span>(<span class="ruby-identifier">head</span>).<span class="ruby-identifier">inject</span>(<span class="ruby-identifier">tr</span>, <span class="ruby-operator">&amp;</span><span class="ruby-value">:&lt;&lt;</span>)
  <span class="ruby-identifier">thead</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">tr</span>
  <span class="ruby-identifier">table</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">thead</span>

  <span class="ruby-identifier">tbody</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;tbody&#39;</span>)
  <span class="ruby-identifier">rows</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">tr</span> = <span class="ruby-identifier">xelem</span>(<span class="ruby-string">&#39;tr&#39;</span>)
    <span class="ruby-identifier">array_to_html</span>(<span class="ruby-identifier">row</span>).<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">x</span>[<span class="ruby-string">&#39;style&#39;</span>] =<span class="ruby-node">&quot;text-align: #{self.align[i].to_s};&quot;</span>
      <span class="ruby-identifier">tr</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">x</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">tbody</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">tr</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xml_newline</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">table</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">tbody</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_table-source -->
          
        </div>

        

        
      </div><!-- to_html_table-method -->

    
      <div id="method-i-to_html_ul" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_ul</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_ul-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 410</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_ul</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@attributes</span>[<span class="ruby-value">:toc</span>]
    <span class="ruby-comment"># render toc</span>
    <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">toc</span>.<span class="ruby-identifier">to_html</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">add_ws</span> <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-string">&#39;ul&#39;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_ul-source -->
          
        </div>

        

        
      </div><!-- to_html_ul-method -->

    
      <div id="method-i-to_html_xml_instr" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_html_xml_instr</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_html_xml_instr-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 860</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_html_xml_instr</span>
  <span class="ruby-identifier">target</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">target</span> <span class="ruby-operator">||</span> <span class="ruby-string">&#39;&#39;</span>
  <span class="ruby-identifier">code</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">code</span> <span class="ruby-operator">||</span> <span class="ruby-string">&#39;&#39;</span>

  <span class="ruby-comment"># A blank target is invalid XML. Just create a text node?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">target</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">xtext</span>(<span class="ruby-node">&quot;&lt;?#{code}?&gt;&quot;</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-node">&quot;&lt;?#{target} #{code}?&gt;&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_html_xml_instr-source -->
          
        </div>

        

        
      </div><!-- to_html_xml_instr-method -->

    
      <div id="method-i-to_latex_ref_definition" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_latex_ref_definition</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_latex_ref_definition-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 912</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_latex_ref_definition</span>
  []
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_latex_ref_definition-source -->
          
        </div>

        

        
      </div><!-- to_latex_ref_definition-method -->

    
      <div id="method-i-wrap_as_element" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">wrap_as_element</span><span
            class="method-args">(name, attributes={})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>renders children as html and wraps into an element of given name</p>

<p>Sets &#39;id&#39; if meta is set</p>
          
          

          
          <div class="method-source-code" id="wrap_as_element-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 330</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">wrap_as_element</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">attributes</span>={})
  <span class="ruby-identifier">html_element</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">children_to_html</span>, <span class="ruby-identifier">attributes</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- wrap_as_element-source -->
          
        </div>

        

        
      </div><!-- wrap_as_element-method -->

    
      <div id="method-i-xelem" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">xelem</span><span
            class="method-args">(type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Helper to create an element</p>
          
          

          
          <div class="method-source-code" id="xelem-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 103</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">xelem</span>(<span class="ruby-identifier">type</span>)
  <span class="ruby-constant">HTMLElement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">type</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- xelem-source -->
          
        </div>

        

        
      </div><!-- xelem-method -->

    
      <div id="method-i-xml_newline" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">xml_newline</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="xml_newline-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 107</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">xml_newline</span>
  <span class="ruby-string">&quot;\n&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- xml_newline-source -->
          
        </div>

        

        
      </div><!-- xml_newline-method -->

    
      <div id="method-i-xtext" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">xtext</span><span
            class="method-args">(text)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Helper to create a text node</p>
          
          

          
          <div class="method-source-code" id="xtext-source">
            <pre><span class="ruby-comment"># File lib/maruku/output/to_html.rb, line 98</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">xtext</span>(<span class="ruby-identifier">text</span>)
  <span class="ruby-constant">MaRuKu</span><span class="ruby-operator">::</span><span class="ruby-constant">Out</span><span class="ruby-operator">::</span><span class="ruby-constant">HTML</span>.<span class="ruby-identifier">escapeHTML</span>(<span class="ruby-identifier">text</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- xtext-source -->
          
        </div>

        

        
      </div><!-- xtext-method -->

    
    </section><!-- public-instance-method-details -->
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Private Instance Methods</h3>

    
      <div id="method-i-run_blahtex" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">run_blahtex</span><span
            class="method-args">(tex, args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Run blahtex, return output</p>
          
          

          
          <div class="method-source-code" id="run_blahtex-source">
            <pre><span class="ruby-comment"># File lib/maruku/ext/math/mathml_engines/blahtex.rb, line 82</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">run_blahtex</span>(<span class="ruby-identifier">tex</span>, <span class="ruby-identifier">args</span>)
  <span class="ruby-constant">IO</span>.<span class="ruby-identifier">popen</span>([<span class="ruby-string">&#39;blahtex&#39;</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>].<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39; &#39;</span>), <span class="ruby-string">&#39;w+&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">blahtex</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">blahtex</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">tex</span>
    <span class="ruby-identifier">blahtex</span>.<span class="ruby-identifier">close_write</span>

    <span class="ruby-identifier">output</span> = <span class="ruby-identifier">blahtex</span>.<span class="ruby-identifier">read</span>
    <span class="ruby-identifier">blahtex</span>.<span class="ruby-identifier">close_read</span>

    <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error running blahtex&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">$?</span>.<span class="ruby-identifier">success?</span>

    <span class="ruby-identifier">output</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- run_blahtex-source -->
          
        </div>

        

        
      </div><!-- run_blahtex-method -->

    
    </section><!-- private-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 4.0.0.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

